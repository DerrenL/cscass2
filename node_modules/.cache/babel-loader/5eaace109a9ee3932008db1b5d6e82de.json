{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\khoo_\\\\OneDrive\\\\Desktop\\\\CSC\\\\cscass2\\\\cscass2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _objectSpread from\"C:\\\\Users\\\\khoo_\\\\OneDrive\\\\Desktop\\\\CSC\\\\cscass2\\\\cscass2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"C:\\\\Users\\\\khoo_\\\\OneDrive\\\\Desktop\\\\CSC\\\\cscass2\\\\cscass2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"C:\\\\Users\\\\khoo_\\\\OneDrive\\\\Desktop\\\\CSC\\\\cscass2\\\\cscass2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\khoo_\\\\OneDrive\\\\Desktop\\\\CSC\\\\cscass2\\\\cscass2\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import React,{useEffect,useReducer}from\"react\";import{loadStripe}from\"@stripe/stripe-js\";import Card from\"components/Card/Card.js\";import CardHeader from\"components/Card/CardHeader.js\";import CardBody from\"components/Card/CardBody.js\";// @material-ui/core components\nimport{makeStyles}from\"@material-ui/core/styles\";import InputAdornment from\"@material-ui/core/InputAdornment\";import Icon from\"@material-ui/core/Icon\";// @material-ui/icons\nimport Email from\"@material-ui/icons/Email\";import People from\"@material-ui/icons/People\";// core components\nimport Header from\"components/Header/Header.js\";import HeaderLinks from\"components/Header/HeaderLinks.js\";import Footer from\"components/Footer/Footer.js\";import GridContainer from\"components/Grid/GridContainer.js\";import GridItem from\"components/Grid/GridItem.js\";import Button from\"components/CustomButtons/Button.js\";import CardFooter from\"components/Card/CardFooter.js\";import CustomInput from\"components/CustomInput/CustomInput.js\";import axios from\"axios\";import{useState}from\"react\";import styles from\"assets/jss/material-kit-react/views/loginPage.js\";var fetchCheckoutSession=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref){var quantity;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:quantity=_ref.quantity;return _context.abrupt(\"return\",fetch(\"https://csc-test-app.herokuapp.com/create-checkout-session\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({quantity:quantity})}).then(function(res){return res.json();}));case 2:case\"end\":return _context.stop();}}},_callee);}));return function fetchCheckoutSession(_x){return _ref2.apply(this,arguments);};}();var formatPrice=function formatPrice(_ref3){var amount=_ref3.amount,currency=_ref3.currency,quantity=_ref3.quantity;var numberFormat=new Intl.NumberFormat(\"en-US\",{style:\"currency\",currency:currency,currencyDisplay:\"symbol\"});var parts=numberFormat.formatToParts(amount);var zeroDecimalCurrency=true;var _iterator=_createForOfIteratorHelper(parts),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var part=_step.value;if(part.type===\"decimal\"){zeroDecimalCurrency=false;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}amount=zeroDecimalCurrency?amount:amount/100;var total=(quantity*amount).toFixed(2);return numberFormat.format(total);};function reducer(state,action){switch(action.type){case\"useEffectUpdate\":return _objectSpread(_objectSpread(_objectSpread({},state),action.payload),{},{price:formatPrice({amount:action.payload.unitAmount,currency:action.payload.currency,quantity:state.quantity})});case\"increment\":return _objectSpread(_objectSpread({},state),{},{quantity:state.quantity+1,price:formatPrice({amount:state.unitAmount,currency:state.currency,quantity:state.quantity+1})});case\"decrement\":return _objectSpread(_objectSpread({},state),{},{quantity:state.quantity-1,price:formatPrice({amount:state.unitAmount,currency:state.currency,quantity:state.quantity-1})});case\"setLoading\":return _objectSpread(_objectSpread({},state),{},{loading:action.payload.loading});case\"setError\":return _objectSpread(_objectSpread({},state),{},{error:action.payload.error});default:throw new Error();}}var Checkout=function Checkout(){var _state$error;var useStyles=makeStyles(styles);var classes=useStyles();var _React$useState=React.useState(\"cardHidden\"),_React$useState2=_slicedToArray(_React$useState,2),cardAnimaton=_React$useState2[0],setCardAnimation=_React$useState2[1];setTimeout(function(){setCardAnimation(\"\");},700);var _useReducer=useReducer(reducer,{quantity:1,price:null,loading:false,error:null,stripe:null}),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];useEffect(function(){function fetchConfig(){return _fetchConfig.apply(this,arguments);}function _fetchConfig(){_fetchConfig=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$fetch$then,publicKey,unitAmount,currency;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"/config\").then(function(res){return res.json();});case 2:_yield$fetch$then=_context2.sent;publicKey=_yield$fetch$then.publicKey;unitAmount=_yield$fetch$then.unitAmount;currency=_yield$fetch$then.currency;_context2.t0=dispatch;_context2.t1=unitAmount;_context2.t2=currency;_context2.next=11;return loadStripe(publicKey);case 11:_context2.t3=_context2.sent;_context2.t4={unitAmount:_context2.t1,currency:_context2.t2,stripe:_context2.t3};_context2.t5={type:\"useEffectUpdate\",payload:_context2.t4};(0,_context2.t0)(_context2.t5);case 15:case\"end\":return _context2.stop();}}},_callee2);}));return _fetchConfig.apply(this,arguments);}fetchConfig();},[]);var handleClick=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event){var _yield$fetchCheckoutS,sessionId,_yield$state$stripe$r,error;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:// Call your backend to create the Checkout session.\ndispatch({type:\"setLoading\",payload:{loading:true}});_context3.next=3;return fetchCheckoutSession({quantity:state.quantity});case 3:_yield$fetchCheckoutS=_context3.sent;sessionId=_yield$fetchCheckoutS.sessionId;_context3.next=7;return state.stripe.redirectToCheckout({sessionId:sessionId});case 7:_yield$state$stripe$r=_context3.sent;error=_yield$state$stripe$r.error;// If `redirectToCheckout` fails due to a browser or network\n// error, display the localized error message to your customer\n// using `error.message`.\nif(error){dispatch({type:\"setError\",payload:{error:error}});dispatch({type:\"setLoading\",payload:{loading:false}});}case 10:case\"end\":return _context3.stop();}}},_callee3);}));return function handleClick(_x2){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(GridContainer,{justify:\"center\"},/*#__PURE__*/React.createElement(GridItem,{xs:12,sm:12,md:12},/*#__PURE__*/React.createElement(Card,{className:classes[cardAnimaton]},/*#__PURE__*/React.createElement(CardHeader,{color:\"primary\",className:classes.cardHeader},/*#__PURE__*/React.createElement(\"h4\",null,\"Subscription Plan\")),/*#__PURE__*/React.createElement(CardBody,null,\"Subscribe now for only $1.00 daily!\"),/*#__PURE__*/React.createElement(CardFooter,{className:classes.cardFooter},/*#__PURE__*/React.createElement(Button,{role:\"link\",onClick:handleClick,disabled:!state.stripe||state.loading,simple:true,color:\"primary\",size:\"lg\"},\"Subscribe\"),/*#__PURE__*/React.createElement(\"div\",{className:\"sr-field-error\"},(_state$error=state.error)===null||_state$error===void 0?void 0:_state$error.message))))))// <div className=\"sr-root\">\n//   <div className=\"sr-main\">\n//     <header className=\"sr-header\">\n//       <div className=\"sr-header__logo\"></div>\n//     </header>\n//     <section className=\"container\">\n//       {/* <div>\n//         <h2>Subscription Plan</h2>\n//         <h4>Subscribe now for only $1.00 daily!</h4>\n//       </div>\n//       <div className=\"quantity-setter\">\n//       </div> */}\n//       <button\n//         role=\"link\"\n//         onClick={handleClick}\n//         disabled={!state.stripe || state.loading}\n//       >\n//         {state.loading || !state.price\n//           ? `Loading...`\n//           : `Buy for ${state.price}`}\n//       </button>\n//       <div className=\"sr-field-error\">{state.error?.message}</div>\n//     </section>\n//   </div>\n// </div>\n;};export default Checkout;","map":{"version":3,"sources":["C:/Users/khoo_/OneDrive/Desktop/CSC/cscass2/cscass2/src/views/Components/Checkout.js"],"names":["React","useEffect","useReducer","loadStripe","Card","CardHeader","CardBody","makeStyles","InputAdornment","Icon","Email","People","Header","HeaderLinks","Footer","GridContainer","GridItem","Button","CardFooter","CustomInput","axios","useState","styles","fetchCheckoutSession","quantity","fetch","method","headers","body","JSON","stringify","then","res","json","formatPrice","amount","currency","numberFormat","Intl","NumberFormat","style","currencyDisplay","parts","formatToParts","zeroDecimalCurrency","part","type","total","toFixed","format","reducer","state","action","payload","price","unitAmount","loading","error","Error","Checkout","useStyles","classes","cardAnimaton","setCardAnimation","setTimeout","stripe","dispatch","fetchConfig","publicKey","handleClick","event","sessionId","redirectToCheckout","cardHeader","cardFooter","message"],"mappings":"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","sourcesContent":["import React, { useEffect, useReducer } from \"react\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport Card from \"components/Card/Card.js\";\r\nimport CardHeader from \"components/Card/CardHeader.js\";\r\nimport CardBody from \"components/Card/CardBody.js\";\r\n// @material-ui/core components\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\r\nimport Icon from \"@material-ui/core/Icon\";\r\n// @material-ui/icons\r\nimport Email from \"@material-ui/icons/Email\";\r\nimport People from \"@material-ui/icons/People\";\r\n// core components\r\nimport Header from \"components/Header/Header.js\";\r\nimport HeaderLinks from \"components/Header/HeaderLinks.js\";\r\nimport Footer from \"components/Footer/Footer.js\";\r\nimport GridContainer from \"components/Grid/GridContainer.js\";\r\nimport GridItem from \"components/Grid/GridItem.js\";\r\nimport Button from \"components/CustomButtons/Button.js\";\r\nimport CardFooter from \"components/Card/CardFooter.js\";\r\nimport CustomInput from \"components/CustomInput/CustomInput.js\";\r\nimport axios from \"axios\";\r\nimport { useState } from \"react\";\r\n\r\nimport styles from \"assets/jss/material-kit-react/views/loginPage.js\";\r\n\r\nconst fetchCheckoutSession = async ({ quantity }) => {\r\n  return fetch(\"https://csc-test-app.herokuapp.com/create-checkout-session\", {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify({\r\n      quantity,\r\n    }),\r\n  }).then((res) => res.json());\r\n};\r\n\r\nconst formatPrice = ({ amount, currency, quantity }) => {\r\n  const numberFormat = new Intl.NumberFormat(\"en-US\", {\r\n    style: \"currency\",\r\n    currency,\r\n    currencyDisplay: \"symbol\",\r\n  });\r\n  const parts = numberFormat.formatToParts(amount);\r\n  let zeroDecimalCurrency = true;\r\n  for (let part of parts) {\r\n    if (part.type === \"decimal\") {\r\n      zeroDecimalCurrency = false;\r\n    }\r\n  }\r\n  amount = zeroDecimalCurrency ? amount : amount / 100;\r\n  const total = (quantity * amount).toFixed(2);\r\n  return numberFormat.format(total);\r\n};\r\n\r\nfunction reducer(state, action) {\r\n  switch (action.type) {\r\n    case \"useEffectUpdate\":\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n        price: formatPrice({\r\n          amount: action.payload.unitAmount,\r\n          currency: action.payload.currency,\r\n          quantity: state.quantity,\r\n        }),\r\n      };\r\n    case \"increment\":\r\n      return {\r\n        ...state,\r\n        quantity: state.quantity + 1,\r\n        price: formatPrice({\r\n          amount: state.unitAmount,\r\n          currency: state.currency,\r\n          quantity: state.quantity + 1,\r\n        }),\r\n      };\r\n    case \"decrement\":\r\n      return {\r\n        ...state,\r\n        quantity: state.quantity - 1,\r\n        price: formatPrice({\r\n          amount: state.unitAmount,\r\n          currency: state.currency,\r\n          quantity: state.quantity - 1,\r\n        }),\r\n      };\r\n    case \"setLoading\":\r\n      return { ...state, loading: action.payload.loading };\r\n    case \"setError\":\r\n      return { ...state, error: action.payload.error };\r\n    default:\r\n      throw new Error();\r\n  }\r\n}\r\n\r\nconst Checkout = () => {\r\n  const useStyles = makeStyles(styles);\r\n  const classes = useStyles();\r\n  const [cardAnimaton, setCardAnimation] = React.useState(\"cardHidden\");\r\n  setTimeout(function () {\r\n    setCardAnimation(\"\");\r\n  }, 700);\r\n  const [state, dispatch] = useReducer(reducer, {\r\n    quantity: 1,\r\n    price: null,\r\n    loading: false,\r\n    error: null,\r\n    stripe: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    async function fetchConfig() {\r\n      // Fetch config from our backend.\r\n      const { publicKey, unitAmount, currency } = await fetch(\r\n        \"/config\"\r\n      ).then((res) => res.json());\r\n      // Make sure to call `loadStripe` outside of a componentâ€™s render to avoid\r\n      // recreating the `Stripe` object on every render.\r\n      dispatch({\r\n        type: \"useEffectUpdate\",\r\n        payload: { unitAmount, currency, stripe: await loadStripe(publicKey) },\r\n      });\r\n    }\r\n    fetchConfig();\r\n  }, []);\r\n\r\n  const handleClick = async (event) => {\r\n    // Call your backend to create the Checkout session.\r\n    dispatch({ type: \"setLoading\", payload: { loading: true } });\r\n    const { sessionId } = await fetchCheckoutSession({\r\n      quantity: state.quantity,\r\n    });\r\n    // When the customer clicks on the button, redirect them to Checkout.\r\n    const { error } = await state.stripe.redirectToCheckout({\r\n      sessionId,\r\n    });\r\n    // If `redirectToCheckout` fails due to a browser or network\r\n    // error, display the localized error message to your customer\r\n    // using `error.message`.\r\n    if (error) {\r\n      dispatch({ type: \"setError\", payload: { error } });\r\n      dispatch({ type: \"setLoading\", payload: { loading: false } });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <GridContainer justify=\"center\">\r\n        <GridItem xs={12} sm={12} md={12}>\r\n          <Card className={classes[cardAnimaton]}>\r\n            <CardHeader color=\"primary\" className={classes.cardHeader}>\r\n              <h4>Subscription Plan</h4>\r\n            </CardHeader>\r\n            <CardBody>Subscribe now for only $1.00 daily!</CardBody>\r\n            <CardFooter className={classes.cardFooter}>\r\n              <Button\r\n                role=\"link\"\r\n                onClick={handleClick}\r\n                disabled={!state.stripe || state.loading}\r\n                simple\r\n                color=\"primary\"\r\n                size=\"lg\"\r\n              >\r\n                Subscribe\r\n              </Button>\r\n              <div className=\"sr-field-error\">{state.error?.message}</div>\r\n            </CardFooter>\r\n          </Card>\r\n        </GridItem>\r\n      </GridContainer>\r\n    </div>\r\n    // <div className=\"sr-root\">\r\n    //   <div className=\"sr-main\">\r\n    //     <header className=\"sr-header\">\r\n    //       <div className=\"sr-header__logo\"></div>\r\n    //     </header>\r\n    //     <section className=\"container\">\r\n\r\n    //       {/* <div>\r\n    //         <h2>Subscription Plan</h2>\r\n    //         <h4>Subscribe now for only $1.00 daily!</h4>\r\n    //       </div>\r\n    //       <div className=\"quantity-setter\">\r\n    //       </div> */}\r\n\r\n    //       <button\r\n    //         role=\"link\"\r\n    //         onClick={handleClick}\r\n    //         disabled={!state.stripe || state.loading}\r\n    //       >\r\n    //         {state.loading || !state.price\r\n    //           ? `Loading...`\r\n    //           : `Buy for ${state.price}`}\r\n    //       </button>\r\n    //       <div className=\"sr-field-error\">{state.error?.message}</div>\r\n    //     </section>\r\n    //   </div>\r\n    // </div>\r\n  );\r\n};\r\n\r\nexport default Checkout;\r\n"]},"metadata":{},"sourceType":"module"}